<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Complexity 2</title>
  <link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
  <link rel="stylesheet" href="/resources/demos/style.css">
  <style>
  #gallery { float: left; width: 65%; min-height: 12em; }
  .gallery.custom-state-active { background: #eee; }
  .gallery li { float: left; width: 96px; padding: 0.4em; margin: 0 0.4em 0.4em 0; text-align: center; }
  .gallery li h5 { margin: 0 0 0.4em; cursor: move; font-size: x-small; }
  .gallery li a { float: right; }
  .gallery li a.ui-icon-zoomin { float: left; }
  .gallery li img { width: 100%; cursor: move; }

  #lowComplexity { float: right; width: 32%; min-height: 18em; padding: 1%; }
  #lowComplexity h4 { line-height: 16px; margin: 0 0 0.4em; }
  #lowComplexity h4 .ui-icon { float: left; }
  #lowComplexity .gallery h5 { display: none; }

  #mediumComplexity { float: right; width: 32%; min-height: 18em; padding: 1%; }
  #mediumComplexity h4 { line-height: 16px; margin: 0 0 0.4em; }
  #mediumComplexity h4 .ui-icon { float: left; }
  #mediumComplexity .gallery h5 { display: none; }

  #highComplexity { float: right; width: 32%; min-height: 18em; padding: 1%; }
  #highComplexity h4 { line-height: 16px; margin: 0 0 0.4em; }
  #highComplexity h4 .ui-icon { float: left; }
  #highComplexity .gallery h5 { display: none; }
  </style>
  <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
  <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
  <script>
  $( function() {
 
    // There's the gallery and the lowComplexity
    var $gallery = $( "#gallery" ),
      $lowComplexity = $( "#lowComplexity" ),
      $mediumComplexity = $( "#mediumComplexity" ),
      $highComplexity = $( "#highComplexity" );
 
    // Let the gallery items be draggable
    $( "li", $gallery ).draggable({
      cancel: "a.ui-icon", // clicking an icon won't initiate dragging
      revert: "invalid", // when not dropped, the item will revert back to its initial position
      containment: "document",
      helper: "clone",
      cursor: "move"
    });
 
    // Let the lowComplexity be droppable, accepting the gallery items
    $lowComplexity.droppable({
      accept: "#gallery > li",
      classes: {
        "ui-droppable-active": "ui-state-highlight"
      },
      drop: function( event, ui ) {
        classifyImageLowComplexity( ui.draggable );
      }
    });

    // Let the mediumComplexity be droppable, accepting the gallery items
    $mediumComplexity.droppable({
      accept: "#gallery > li",
      classes: {
        "ui-droppable-active": "ui-state-highlight"
      },
      drop: function( event, ui ) {
        classifyImageMediumComplexity( ui.draggable );
      }
    });

    // Let the mediumComplexity be droppable, accepting the gallery items
    $highComplexity.droppable({
      accept: "#gallery > li",
      classes: {
        "ui-droppable-active": "ui-state-highlight"
      },
      drop: function( event, ui ) {
        classifyImageHighComplexity( ui.draggable );
      }
    });

    // Let the gallery be droppable as well, accepting items from the lowComplexity mediumComplexity highComplexity
    $gallery.droppable({
      accept: ["#lowComplexity li", "#mediumComplexity li", "#highComplexity li"],
      classes: {
        "ui-droppable-active": "custom-state-active"
      },
      drop: function( event, ui ) {
        recycleImage( ui.draggable );
      }
    });
 
    // Image deletion function
    var recycle_icon = "<a href='link/to/recycle/script/when/we/have/js/off' title='Recycle this image' class='ui-icon ui-icon-refresh'>Recycle image</a>";
    function classifyImageLowComplexity( $item ) {
      $item.fadeOut(function() {
        var $list = $( "ul", $lowComplexity ).length ?
          $( "ul", $lowComplexity ) :
          $( "<ul class='gallery ui-helper-reset'/>" ).appendTo( $lowComplexity );
 
        $item.find( "a.ui-icon-trash" ).remove();
        $item.append( recycle_icon ).appendTo( $list ).fadeIn(function() {
          $item
            .animate({ width: "48px" })
            .find( "img" )
              .animate({ height: "36px" });
        });
      });
    }

    function classifyImageMediumComplexity( $item ) {
      $item.fadeOut(function() {
        var $list = $( "ul", $mediumComplexity ).length ?
          $( "ul", $mediumComplexity ) :
          $( "<ul class='gallery ui-helper-reset'/>" ).appendTo( $mediumComplexity );
 
        $item.find( "a.ui-icon-trash" ).remove();
        $item.append( recycle_icon ).appendTo( $list ).fadeIn(function() {
          $item
            .animate({ width: "48px" })
            .find( "img" )
              .animate({ height: "36px" });
        });
      });
    }

    function classifyImageHighComplexity( $item ) {
      $item.fadeOut(function() {
        var $list = $( "ul", $highComplexity ).length ?
          $( "ul", $highComplexity ) :
          $( "<ul class='gallery ui-helper-reset'/>" ).appendTo( $highComplexity );

        $item.find( "a.ui-icon-trash" ).remove();
        $item.append( recycle_icon ).appendTo( $list ).fadeIn(function() {
          $item
            .animate({ width: "48px" })
            .find( "img" )
              .animate({ height: "36px" });
        });
      });
    }
 
    // Image recycle function
    var trash_icon = "<a href='link/to/trash/script/when/we/have/js/off' title='Delete this image' class='ui-icon ui-icon-trash'>Delete image</a>";
    function recycleImage( $item ) {
      $item.fadeOut(function() {
        $item
          .find( "a.ui-icon-refresh" )
            .remove()
          .end()
          .css( "width", "96px")
          //.append( trash_icon )
          .find( "img" )
            .css( "height", "72px" )
          .end()
          .appendTo( $gallery )
          .fadeIn();
      });
    }
 
    // Image preview function, demonstrating the ui.dialog used as a modal window
    function viewLargerImage( $link ) {
      var src = $link.attr( "href" ),
        title = $link.siblings( "img" ).attr( "alt" ),
        $modal = $( "img[src$='" + src + "']" );
 
      if ( $modal.length ) {
        $modal.dialog( "open" );
      } else {
        var img = $( "<img alt='" + title + "' width='384' height='288' style='display: none; padding: 8px;' />" )
          .attr( "src", src ).appendTo( "body" );
        setTimeout(function() {
          img.dialog({
            title: title,
            width: 400,
            modal: true
          });
        }, 1 );
      }
    }
 
    // Resolve the icons behavior with event delegation
    $( "ul.gallery > li" ).on( "click", function( event ) {
      var $item = $( this ),
        $target = $( event.target );
 
      /* if ( $target.is( "a.ui-icon-trash" ) ) {
        classifyImageLowComplexity( $item );
      } else */ if ( $target.is( "a.ui-icon-zoomin" ) ) {
        viewLargerImage( $target );
      } else if ( $target.is( "a.ui-icon-refresh" ) ) {
        recycleImage( $item );
      }
 
      return false;
    });
  } );
  </script>
</head>
<body>
 
<div class="ui-widget ui-helper-clearfix">
 
<ul id="gallery" class="gallery ui-helper-reset ui-helper-clearfix">
   <script>
  cities = ['Rome', 'London', 'Barcelona', 'New York', 'Kaysersberg', 'Pedraza', 'Marrakesh', 
	'St Johns', 'Pingyao', 'Kowloon', 'Truro', 'Trento', 'Durham', 'Augsburg', 'Mittenwald', 
	'San Juan', 'Toxteth', 'Idstein', 'Mantova', 'Gloucester', 'Goslar', 'Lincoln', 'Vienna', 
	'Bacolod City', 'Manchester', 'Barcelona', 'La Paz', 'St Petersburg', 'Zermatt', 'Venlo', 
	'Copenhagen', 'Lund', 'Brixen', 'York', 'Wells', 'Wiesbaden', 'Annecy', 'Venice'];

  for (var i = 0; i < cities.length; i++) {
    tmp = '<li class="ui-widget-content ui-corner-tr">';
    tmp += `<h5 class="ui-widget-header">${1+i}. ${cities[i]}</h5>`;
    tmp += `<img src="thumbnails/${1+i}a.jpg" alt="${1+i}. ${cities[i]}" width="96" height="72">`;
    tmp += `<a href="large/${1+i}a.jpg" title="View larger image" class="ui-icon ui-icon-zoomin">View larger</a>`;
    tmp += '</li>';
    document.write(tmp);
  }
  </script>
</ul>

<div id="lowComplexity" class="ui-widget-content ui-state-default">
  <h4 class="ui-widget-header">Low complexity</h4>
</div>

<div id="mediumComplexity" class="ui-widget-content ui-state-default">
  <h4 class="ui-widget-header">Medium complexity</h4>
</div>

<div id="highComplexity" class="ui-widget-content ui-state-default">
  <h4 class="ui-widget-header">High complexity</h4>
</div>

</div>
 
 
</body>
</html>